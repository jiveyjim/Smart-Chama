{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- NAVBAR -->
<nav class="navbar">
    <div class="logo">Smart Chama</div>
    <ul>
        <li><a href="{% url 'member_home' %}" id="btn-nav">Home</a></li>
        <li><a href="{% url 'deposit' %}" id="btn-nav">Deposit</a></li>
        <li><a href="{% url 'withdraw' %}" id="btn-nav">Withdraw</a></li>
        <li><a href="{% url 'member_list' %}" id="btn-nav">Members</a></li>
        <li><a href="{% url 'statements' %}" id="btn-nav">Statements</a></li>
        <li><a href="{% url 'withdrawal_timeline' %}" id="btn-nav">Withdrawal Timeline</a></li>
        <li><a href="{% url 'logout' %}" id="btn-nav">Log Out</a></li>
    </ul>
</nav>

<div class="container">
    <h1 class="page-title">My Statements</h1>
    <p class="lead" style="text-align:center;">Review all your contributions and withdrawals below:</p>

    <div class="table-card">
        <table class="members-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Transaction Type</th>
                    <th>Amount (KSh)</th>
                    <th>Date</th>
                    <th>MPESA Ref / Notes</th>
                    <th>Balance After</th>
                </tr>
            </thead>
            <tbody>
                {% if statements %}
                    {% for statement in statements %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>
                            {% if statement.transaction_type == 'deposit' %}
                                <span style="color: green; font-weight:bold;">Deposit</span>
                            {% else %}
                                <span style="color: red; font-weight:bold;">Withdrawal</span>
                            {% endif %}
                        </td>
                        <td>{{ statement.amount|floatformat:2 }}</td>
                        <td>{{ statement.date|date:"M d, Y - h:i A" }}</td>
                        <td>
                            {% if statement.mpesa_ref %}
                                {{ statement.mpesa_ref }}
                            {% else %}
                                {{ statement.notes }}
                            {% endif %}
                        </td>
                        <td>{{ statement.balance_after|floatformat:2 }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="6" style="text-align:center; padding:20px; color:#666;">
                            No statements available.
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}
